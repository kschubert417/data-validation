<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Form Settings</title>
</head>

<body>

    <h1>Form Settings{{file_name}}</h1>
    <!-- Form content here -->
    <!--Notes:
        Could use table name passed into template
        -->
    <h1>Form with CSV Columns</h1>
    <form method="POST" action="/submit?file={{file_name}}">
        {% for column in column_names %}
        <label>{{ column }}</label><br />
        <!--
        <select name="{{ column }}" class="select-control">
            <option value="normal_field" selected>Normal Field</option>
            <option value="primary_key">Primary Key</option>
            <option value="foreign_key">Foreign Key</option>
            <option value="allowed_values">Allowed Values</option>
        </select>
        -->
        <!--Selecting table and column for foreign key-->
        <div class="double-textbox-container">
            <!--Selecting table-->
            <select name="foreignkey_table_{{ column }}" class="table-select">
                <option value="" selected disabled hidden>Choose FK Table</option>
                <option value="normal_field">PRODFAM</option>
            </select>
            <!--Selecting column-->
            <select name="foreignkey_column_{{ column }}" class="column-select">
                <option value="" selected disabled hidden>Choose FK Column</option>
                <option value="normal_field">PRODFAM</option>
                <option value="normal_field">DESCRIPTION</option>
            </select>
        </div>
        -->
        <div>
            
            <select name="foreignkey_column_{{ column }}" class="column-select">
                {% for column in col_names%}
              <option value="normal_field">{{column}}</option>
                {% endfor %}
            </select>
        </div>
        <!--User input for allowed values for certain columns
        <div class="textbox-container">
            <input name="allowedvalues_masterfile_{{ column }}" type="text" placeholder="Allowed values for {{ column }}" />
        </div>
        <br /><br />
        {% endfor %}
        -->
        <button type="submit">Submit</button>
    </form>
</body>



<script>
    // Get all select elements with the class "select-control"
    var selects = document.querySelectorAll(".select-control");

    selects.forEach(function (select) {
        select.addEventListener("change", function () {
            var singleTextboxContainer = this.nextElementSibling.nextElementSibling;
            var doubleTextboxContainer = this.nextElementSibling;

            // Hide both initially
            singleTextboxContainer.style.display = "none";
            doubleTextboxContainer.style.display = "none";

            // Check the selected option and show the relevant container
            if (this.value === "foreign_key") {
                doubleTextboxContainer.style.display = "inline-block";
            } else if (this.value === "allowed_values") {
                singleTextboxContainer.style.display = "inline-block";
            }
        });
    });

    // Initialize on load
    window.onload = function () {
        selects.forEach(function (select) {
            var singleTextboxContainer =
                select.nextElementSibling.nextElementSibling;
            var doubleTextboxContainer = select.nextElementSibling;

            // Initial visibility based on current option selected
            if (select.value === "foreign_key") {
                doubleTextboxContainer.style.display = "inline-block";
            } else if (select.value === "allowed_values") {
                singleTextboxContainer.style.display = "inline-block";
            } else {
                singleTextboxContainer.style.display = "none";
                doubleTextboxContainer.style.display = "none";
            }
        });
    };
</script>
</html>